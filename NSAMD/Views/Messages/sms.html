
<div class="smsContent" ng-init="smc.init()" flex>
    <div layout="row" class="smsRow">
        <div layout="column" flex="40">
            <md-list class="smsList">
                <!--<md-list-item ng-repeat="user in smc.correspondencesOrdered = (smc.correspondences | orderBy : '-LastMessageDate')" -->
                <!--| orderBy: '-lastMessageDate'-->
                <!--track by user.id-->

                <md-list-item ng-repeat="user in smc.correspondences | filter: smc.filterMessageGroups"
                              class="md-2-line"
                              ng-click="smc.viewMessages($index, user)"
                              ng-class="{'selected': $index==smc.selectedIndex}">

                    <div layout="row" layout-align="space-between start" style="width:100%;">
                        <div class="md-list-item-text correspondenceFrom" layout="column" layout-align="start start" flex>
                            <span class="correspondencePrimary">{{user.name}}</span>
                            <span class="correspondenceSecondary truncate" style="padding-top:2px;min-height: 19.5px">{{ user.lastMessageBody}}</span>
                        </div>

                        <!-- style="position:relative;" -->
                        <div class="correspondenceDate correspondenceSecondary" layout="column" layout-align="end end" >
                                {{mc.formatDate(user.lastMessageDate)}}
                                <!-- ng-md-icon icon="more_horiz" ng-click="smc.testMore($event)" ></ng-md-icon-->

                                <!--md-button class="md-icon-button messageGroupMenuButton" ng-click="smc.testMore($event)" aria-label="call">
                                    <ng-md-icon icon="more_horiz"></ng-md-icon>
                                </md-button-->
                                  
                                <!-- position: absolute;top: 25px;right: 15px; -->
                             <div style="width: auto;padding-top:6px;">                    
                                    <md-menu md-position-mode="target-right target">
                                        <md-button aria-label="Open phone interactions menu" 
                                        class="md-icon-button messageGroupMenuButton" 
                                        ng-click="smc.openMenu($mdMenu, $event)" 
                                        style="width:auto;">
                                            <ng-md-icon icon="more_horiz" md-menu-origin></ng-md-icon>
                                        </md-button>
                                        <md-menu-content width="3">
                                          <md-menu-item>
                                            <md-button ng-click="smc.edit(user, $event)">
                                                <div layout="row" flex>
                                                        <p flex>Edit</p>
                                                        <ng-md-icon icon="edit" md-menu-align-target style="margin: auto 3px auto 0;"></ng-md-icon>  
                                                </div>
                                            </md-button>
                                          </md-menu-item>
                                          <md-menu-item>
                                            <md-button ng-click="smc.hide(user, $event)">
                                                <div layout="row" flex>
                                                    <p flex>Hide</p>
                                                    <ng-md-icon icon="remove_circle_outline" md-menu-align-target style="margin: auto 3px auto 0;"></ng-md-icon>  
                                                </div>
                                            </md-button>
                                          </md-menu-item>
                                          <md-menu-divider></md-menu-divider>
                                          <md-menu-item>
                                            <md-button ng-click="smc.delete(user, $event)">
                                                <div layout="row" flex>
                                                    <p flex>Delete</p>
                                                    <ng-md-icon icon="delete" md-menu-align-target style="margin: auto 3px auto 0;"></ng-md-icon>  
                                                </div>
                                            </md-button>
                                          </md-menu-item>
                                        </md-menu-content>
                                      </md-menu>
                                </div>
                        </div>

                    </div>

                    <md-divider ng-if="!$last"></md-divider>
                </md-list-item>
            </md-list>
        </div>
        <div layout="column" flex>
            <md-toolbar class="userToolbar" layout="column" layout-align="center center" 
                        md-colors="::{background: 'default-accent-500-1', color: 'default-primary-500-1'}">
                    <span>{{smc.selectedItem.name}}</span>
            </md-toolbar>

            <div layout="column" layout-align="end start" layout-padding flex>
                <div  style="align-self:flex-start;" ng-repeat="msg in smc.selectedItem.messages | orderBy: 'messageDate'" layout-padding
                     class="{{ msg.messageDirectionEnumID == 53 ? 'smsSent' : 'smsReceived'}}">
                    <div>
                        {{msg.body}}
                    </div>
                    <div class="smsDate">
                        {{ smc.formatDate(msg.messageDate) }}
                     </div>
                </div>
            </div>
            <div layout="row" layout-align="space-between center" layout-padding class="smsSendContainer"> 
                <form ng-submit="smc.sendSms()" flex style="display:flex;flex-direction:row;align-items:center;">
                    <md-input-container flex>
                        <input ng-model="smc.smsContent">
                    </md-input-container>
                    <ng-md-icon icon="send" ng-click="smc.sendSms()"></ng-md-icon>
                </form>
            </div>
        </div>
    </div>
</div>
